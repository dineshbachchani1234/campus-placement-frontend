<div class="dashboard-container">
  <h1>Student Dashboard</h1>
    
  <!-- Applications Section -->
  <section class="dashboard-section">
    <h2>My Applications</h2>
    <mat-card *ngIf="applications.length === 0">
      <mat-card-content>
        <p>You haven't applied to any jobs yet.</p>
      </mat-card-content>
    </mat-card>
    
    <div *ngIf="applications.length > 0">
      <table mat-table [dataSource]="paginatedApplications" class="mat-elevation-z8">
        <!-- Job Title Column -->
        <ng-container matColumnDef="jobTitle">
          <th mat-header-cell *matHeaderCellDef>Job Title</th>
          <td mat-cell *matCellDef="let application">{{application.job?.title || 'N/A'}}</td>
        </ng-container>
        
        <!-- Company Column -->
        <ng-container matColumnDef="companyName">
          <th mat-header-cell *matHeaderCellDef>Company</th>
          <td mat-cell *matCellDef="let application">{{application.job?.company?.companyName || 'N/A'}}</td>
        </ng-container>
        
        <!-- Job Type Column -->
        <ng-container matColumnDef="jobType">
          <th mat-header-cell *matHeaderCellDef>Job Type</th>
          <td mat-cell *matCellDef="let application">{{formatJobType(application.job?.jobType)}}</td>
        </ng-container>
        
        <!-- Salary Column -->
        <ng-container matColumnDef="salary">
          <th mat-header-cell *matHeaderCellDef>Salary</th>
          <td mat-cell *matCellDef="let application">{{formatSalary(application.job?.salary)}}</td>
        </ng-container>
        
        <!-- Status Column -->
        <ng-container matColumnDef="status">
          <th mat-header-cell *matHeaderCellDef>Status</th>
          <td mat-cell *matCellDef="let application">
            <span class="status-badge" [ngClass]="'application-status-' + application.status?.toLowerCase()">
              {{formatStatus(application.status)}}
            </span>
          </td>
        </ng-container>
        
        <!-- Application Date Column -->
        <ng-container matColumnDef="applicationDate">
          <th mat-header-cell *matHeaderCellDef>Applied On</th>
          <td mat-cell *matCellDef="let application">{{formatDate(application.applicationDate)}}</td>
        </ng-container>
        
        <!-- Deadline Column -->
        <ng-container matColumnDef="deadline">
          <th mat-header-cell *matHeaderCellDef>Deadline</th>
          <td mat-cell *matCellDef="let application">{{formatDate(application.job?.deadline)}}</td>
        </ng-container>

        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef>Actions</th>
          <td mat-cell *matCellDef="let application">
            <button 
              mat-button 
              color="warn" 
              [disabled]="application.status === ApplicationStatus.ACCEPTED" 
              (click)="withdrawApplication(application)">
              Withdraw
            </button>
          </td>
        </ng-container>
        
        <tr mat-header-row *matHeaderRowDef="displayedColumnsApplications"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumnsApplications;"></tr>
      </table>

      <mat-paginator
      [length]="applications.length"
      [pageSize]="pageSize"
      [pageSizeOptions]="pageSizeOptions"
      [pageIndex]="applicationsPageIndex"
      (page)="onApplicationsPageChange($event)"
      aria-label="Select page of applications">
    </mat-paginator>
    </div>
  </section>
  
  <!-- Interviews Section -->
  <section class="dashboard-section">
    <h2>My Interviews</h2>
    <mat-card *ngIf="interviews.length === 0">
      <mat-card-content>
        <p>You don't have any interviews scheduled.</p>
      </mat-card-content>
    </mat-card>
    
    <div *ngIf="interviews.length > 0">
      <table mat-table [dataSource]="paginatedInterviews" class="mat-elevation-z8">
        <!-- Job Title Column -->
        <ng-container matColumnDef="jobTitle">
          <th mat-header-cell *matHeaderCellDef>Job Title</th>
          <td mat-cell *matCellDef="let interview">{{interview.application?.job?.title || 'N/A'}}</td>
        </ng-container>
        
        <!-- Company Column -->
        <ng-container matColumnDef="companyName">
          <th mat-header-cell *matHeaderCellDef>Company</th>
          <td mat-cell *matCellDef="let interview">{{interview.application?.job?.company?.companyName || 'N/A'}}</td>
        </ng-container>
        
        <!-- Interview Date Column -->
        <ng-container matColumnDef="interviewDate">
          <th mat-header-cell *matHeaderCellDef>Interview Date</th>
          <td mat-cell *matCellDef="let interview">{{formatDateTime(interview.interviewDate)}}</td>
        </ng-container>
        
        <!-- Status Column -->
        <ng-container matColumnDef="status">
          <th mat-header-cell *matHeaderCellDef>Status</th>
          <td mat-cell *matCellDef="let interview">
            <span class="status-chip" [ngClass]="getStatusClass(interview.status)">
              {{formatStatus(interview.status)}}
            </span>
          </td>
        </ng-container>
        
        <!-- Result Column -->
        <ng-container matColumnDef="result">
          <th mat-header-cell *matHeaderCellDef>Result</th>
          <td mat-cell *matCellDef="let interview">
            <span class="result-chip" [ngClass]="getResultClass(interview.result)">
              {{interview.result ? formatStatus(interview.result) : 'Pending'}}
            </span>
          </td>
        </ng-container>
        
        <!-- Feedback Column -->
        <ng-container matColumnDef="feedback">
          <th mat-header-cell *matHeaderCellDef>Feedback</th>
          <td mat-cell *matCellDef="let interview">
            <span *ngIf="interview.feedback" class="feedback-text">{{interview.feedback}}</span>
            <span *ngIf="!interview.feedback" class="no-feedback">No feedback yet</span>
          </td>
        </ng-container>
        
        <!-- Actions Column -->
        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef>Actions</th>
          <td mat-cell *matCellDef="let interview">
            <button 
              *ngIf="interview.status === InterviewStatus.COMPLETED" 
              mat-button 
              color="primary" 
              class="action-button"
              (click)="addInterviewExperience(interview)">
              <span class="material-icons">rate_review</span>
              Share Experience
            </button>
            
            <button 
              *ngIf="interview.status === InterviewStatus.SCHEDULED" 
              mat-button  
              color="accent" 
              class="action-button" 
              disabled>
              <span class="material-icons">event</span>
              Scheduled
            </button>
            
            <span 
              *ngIf="interview.status === InterviewStatus.CANCELLED" 
              class="cancelled-badge">
              <span class="material-icons">event_busy</span>
              Cancelled
            </span>
          </td>
        </ng-container>
        
        <tr mat-header-row *matHeaderRowDef="displayedColumnsInterviews"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumnsInterviews;"></tr>
      </table>
      <mat-paginator
      [length]="interviews.length"
      [pageSize]="pageSize"
      [pageSizeOptions]="pageSizeOptions"
      [pageIndex]="interviewsPageIndex"
      (page)="onInterviewsPageChange($event)"
      aria-label="Select page of interviews">
    </mat-paginator>
    </div>
  </section>
  
  <!-- Career Fairs Section -->
  <section class="dashboard-section">
    <h2>Upcoming Career Fairs</h2>
    <mat-card *ngIf="careerFairs.length === 0">
      <mat-card-content>
        <p>No upcoming career fairs.</p>
      </mat-card-content>
    </mat-card>
    
    <div *ngIf="careerFairs.length > 0">
      <table mat-table [dataSource]="paginatedCareerFairs" class="mat-elevation-z8">
        <!-- Title Column -->
        <ng-container matColumnDef="title">
          <th mat-header-cell *matHeaderCellDef>Title</th>
          <td mat-cell *matCellDef="let event">{{event.title || 'N/A'}}</td>
        </ng-container>
        
        <!-- Date Column -->
        <ng-container matColumnDef="date">
          <th mat-header-cell *matHeaderCellDef>Date</th>
          <td mat-cell *matCellDef="let event">{{formatDate(event.date)}}</td>
        </ng-container>
        
        <!-- Location Column -->
        <ng-container matColumnDef="location">
          <th mat-header-cell *matHeaderCellDef>Location</th>
          <td mat-cell *matCellDef="let event">{{event.location || 'TBD'}}</td>
        </ng-container>
        
        <!-- Description Column -->
        <ng-container matColumnDef="description">
          <th mat-header-cell *matHeaderCellDef>Description</th>
          <td mat-cell *matCellDef="let event">
            {{event.description?.length > 50 ? (event.description | slice:0:50) + '...' : (event.description || 'No description')}}
          </td>
        </ng-container>
        
        <tr mat-header-row *matHeaderRowDef="displayedColumnsCareerFairs"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumnsCareerFairs;"></tr>
      </table>

      <mat-paginator
      [length]="careerFairs.length"
      [pageSize]="pageSize"
      [pageSizeOptions]="pageSizeOptions"
      [pageIndex]="careerFairsPageIndex"
      (page)="onCareerFairsPageChange($event)"
      aria-label="Select page of career fairs">
    </mat-paginator>

    </div>
  </section>

  <!-- ... available job section ... -->

<section class="dashboard-section">
  <h2>Available Jobs</h2>
  <mat-card *ngIf="jobs.length === 0">
    <mat-card-content>
      <p>No jobs are currently available.</p>
    </mat-card-content>
  </mat-card>

  <div *ngIf="jobs.length > 0">
    <table mat-table [dataSource]="paginatedJobs" class="mat-elevation-z8">

      <!-- Title Column -->
      <ng-container matColumnDef="title">
        <th mat-header-cell *matHeaderCellDef>Title</th>
        <td mat-cell *matCellDef="let job">{{ job.title }}</td>
      </ng-container>

      <!-- Job Type Column -->
      <ng-container matColumnDef="jobType">
        <th mat-header-cell *matHeaderCellDef>Type</th>
        <td mat-cell *matCellDef="let job">{{ formatJobType(job.jobType) }}</td>
      </ng-container>

      <!-- Salary Column -->
      <ng-container matColumnDef="salary">
        <th mat-header-cell *matHeaderCellDef>Salary</th>
        <td mat-cell *matCellDef="let job">{{ formatSalary(job.salary) }}</td>
      </ng-container>

      <!-- Action Column -->
      <ng-container matColumnDef="action">
        <th mat-header-cell *matHeaderCellDef>Action</th>
        <td mat-cell *matCellDef="let job">
          <button
            mat-raised-button
            [color]="job.hasApplied ? 'accent' : 'primary'"
            [disabled]="job.hasApplied"
            (click)="applyToJob(job)">
            {{ job.hasApplied ? 'Applied' : 'Apply' }}
          </button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumnsJobs"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumnsJobs;"></tr>
    </table>

    <mat-paginator
      [length]="jobs.length"
      [pageSize]="pageSize"
      [pageSizeOptions]="pageSizeOptions"
      [pageIndex]="jobsPageIndex"
      (page)="onJobsPageChange($event)"
      aria-label="Select page of jobs">
    </mat-paginator>

  </div>
</section>


<section class="dashboard-section">
  <h2>Recent Interview Experiences</h2>
  <mat-card *ngIf="interviewExperiences.length === 0">
    <mat-card-content>
      <p>No interview experiences shared yet. Be the first to share your experience!</p>
    </mat-card-content>
  </mat-card>
  
  <div *ngIf="interviewExperiences.length > 0" class="experience-grid">
    <mat-card class="experience-card" *ngFor="let exp of interviewExperiences.slice(0, 4)">
      <mat-card-header>
        <mat-card-title>{{ exp.interview.application?.job?.company?.companyName || 'Company' }}</mat-card-title>
        <mat-card-subtitle>{{ exp.interview.application?.job?.title || 'Position' }}</mat-card-subtitle>
        <div class="rating-container">
          <span *ngFor="let star of [1,2,3,4,5]" class="rating-star">
            <span>{{ star <= exp.rating ? '★' : '☆' }}</span>
          </span>
        </div>
      </mat-card-header>
      
      <mat-card-content>
        <p class="experience-comment">{{ exp.comment }}</p>
      </mat-card-content>
      
      <mat-card-footer>
        <div class="experience-footer">
          <span class="experience-author">
            {{ exp.student.firstName || 'Anonymous' }} {{ exp.student.lastName || '' }}
          </span>
          <span class="experience-date">
            {{ exp.postDate ? formatDate(exp.postDate) : 'Recently' }}
          </span>
        </div>
      </mat-card-footer>
    </mat-card>
    
    <button 
      *ngIf="interviewExperiences.length > 4" 
      mat-button 
      color="primary" 
      class="view-all-btn"
      (click)="openExperiencesDialog()">
      View All Experiences
    </button>
  </div>
</section>

<!-- Skills Section -->
<section class="dashboard-section">
  <h2>My Skills</h2>
  <mat-card>
    <mat-card-content>
      <div *ngIf="skills.length === 0" class="empty-state">
        <p>You haven't added any skills yet.</p>
      </div>

      <mat-chip-listbox *ngIf="skills.length > 0" aria-label="Skills list" class="skill-chips">
        <mat-chip-option *ngFor="let skill of skills" class="skill-chip">
          {{ skill.skillName }}
          <button matChipRemove (click)="deleteSkill(skill.skillId)">
            <mat-icon>cancel</mat-icon>
          </button>
        </mat-chip-option>
      </mat-chip-listbox>

      <div class="add-item-form">
        <mat-form-field appearance="fill">
          <mat-label>New Skill Name</mat-label>
          <input matInput [(ngModel)]="newSkillName" placeholder="e.g., Java, Python, Angular">
        </mat-form-field>
        <button mat-raised-button color="primary" (click)="addSkill()" [disabled]="!newSkillName.trim()">Add Skill</button>
      </div>
    </mat-card-content>
  </mat-card>
</section>

<!-- Certifications Section -->
<section class="dashboard-section">
  <h2>My Certifications</h2>
  <mat-card>
    <mat-card-content>
      <div *ngIf="certifications.length === 0" class="empty-state">
        <p>You haven't added any certifications yet.</p>
      </div>

      <mat-list *ngIf="certifications.length > 0" class="certification-list">
        <mat-list-item *ngFor="let cert of certifications">
          <span matListItemTitle>{{ cert.name }}</span>
          <span matListItemLine>Date: {{ formatDate(cert.certificationDate) }}</span>
          <button mat-icon-button (click)="deleteCertification(cert.certificationId)" aria-label="Delete certification">
            <mat-icon>delete</mat-icon>
          </button>
        </mat-list-item>
      </mat-list>

      <div class="add-item-form">
        <mat-form-field appearance="fill">
          <mat-label>Certification Name</mat-label>
          <input matInput [(ngModel)]="newCertificationName" placeholder="e.g., AWS Certified Developer" required>
        </mat-form-field>
        <mat-form-field appearance="fill">
          <mat-label>Issuing Organization</mat-label>
          <input matInput [(ngModel)]="newCertificationOrg" placeholder="e.g., Amazon Web Services" required>
        </mat-form-field>
        <mat-form-field appearance="fill">
          <mat-label>Certification Date</mat-label>
          <input matInput type="date" [(ngModel)]="newCertificationDate" required>
        </mat-form-field>
        <mat-form-field appearance="fill">
          <mat-label>Expiry Date (Optional)</mat-label>
          <input matInput type="date" [(ngModel)]="newCertificationExpiry">
        </mat-form-field>
        <mat-form-field appearance="fill">
          <mat-label>Credential ID (Optional)</mat-label>
          <input matInput [(ngModel)]="newCertificationCredentialId" placeholder="e.g., ABC-123-XYZ">
        </mat-form-field>
        <button mat-raised-button color="primary" (click)="addCertification()" [disabled]="!newCertificationName.trim() || !newCertificationOrg.trim() || !newCertificationDate">Add Certification</button>
      </div>
    </mat-card-content>
  </mat-card>
</section>

<!-- Template for the dialog -->
<ng-template #experiencesDialog>
  <h2 mat-dialog-title>All Interview Experiences</h2>
  <mat-dialog-content class="all-experiences-container">
    <mat-card class="experience-card" *ngFor="let exp of interviewExperiences">
      <mat-card-header>
        <mat-card-title>{{ exp.interview.application?.job?.company?.companyName || 'Company' }}</mat-card-title>
        <mat-card-subtitle>{{ exp.interview.application?.job?.title || 'Position' }}</mat-card-subtitle>
        <div class="rating-container">
          <span *ngFor="let star of [1,2,3,4,5]" class="rating-star">
            <span>{{ star <= exp.rating ? '★' : '☆' }}</span>
          </span>
        </div>
      </mat-card-header>
      
      <mat-card-content>
        <p class="experience-comment full">{{ exp.comment }}</p>
      </mat-card-content>
      
      <mat-card-footer>
        <div class="experience-footer">
          <span class="experience-author">
            {{ exp.student.firstName || 'Anonymous' }} {{ exp.student.lastName || '' }}
          </span>
          <span class="experience-date">
            {{ exp.postDate ? formatDate(exp.postDate) : 'Recently' }}
          </span>
        </div>
      </mat-card-footer>
    </mat-card>
  </mat-dialog-content>
  <mat-dialog-actions>
    <button mat-button mat-dialog-close>Close</button>
  </mat-dialog-actions>
</ng-template>


</div>
